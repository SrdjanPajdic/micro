!function(e,t){function n(t){this.props=t,this.id=i.getUniqueId(),this.events=new n.Pubsub(this.id),this.defaultTile=e.document.title;var o=new n.Router(this.props.pages,this.events),r=new n.Tpl(this.props.options,this.events);this.initEventsLogic(o,r),o.invoke();var a=this;return{page:o.path.bind(o),load:r.loadTpl.bind(r),render:r.render.bind(r),compile:r.parseTpl.bind(r),setAnimation:function(e){r.props.enterAnimation=e},getPage:function(e){var t=Object.keys(e)[0];return a.props.pages.filter(function(n){return n[t]==e[t]})[0]}}}var i=function(){function e(e){var t,n,i;for(i=e.length;i;i--)t=Math.floor(Math.random()*i),n=e[i-1],e[i-1]=e[t],e[t]=n;return e.join("")}var t=this;return t.getRandomInt=function(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e))+e},t.getUniqueId=function(){return e(((new Date).getTime().toString()+t.getRandomInt(1,1e4).toString()).split("")).trim()},t}();n.prototype={isMicro:!0,eventsAdded:!1,initEventsLogic:function(t,n){if(!this.eventsAdded){var i=this;i.events.on("routeChange",t.path.bind(t)),i.events.on("routeMatch",n.loadTpl.bind(n));var o=function(e,t,n){var o=e.page;o.on&&"function"==typeof o.on[n]&&o.on[n](o,t);var r=i.props.options;r.on&&"function"==typeof r.on[n]&&r.on[n](e,t)};i.events.on("beforerender",function(t,n){var r=t.page.title;e.document.title=r?r:i.defaultTile,o(t,n,"beforerender")}),i.events.on("render",function(e,t){o(e,t,"render"),i.setListeners()}),e.addEventListener&&e.addEventListener("popstate",t.invoke.bind(t)),i.eventsAdded=!0}},microLinkClick:function(t){var t=e.e||t,n=t.target;if("A"==n.tagName&&(t.preventDefault(),n.hasAttribute("micro-route")))return this.events.fire("routeChange",n.getAttribute("micro-route")),!1},setListeners:function(){var e=this;setTimeout(function(){Array.prototype.slice.call(t.querySelectorAll("[micro-route]")).forEach(function(t){(!t.microId||t.microId&&t.microId.length&&t.microId.indexOf(e.id)<0)&&(t.microId||(t.microId=[]),t.addEventListener?t.addEventListener("click",function(t){e.microLinkClick(t)},!1):t.attachEvent("onclick",function(t){e.microLinkClick(t)}),t.microId.push(e.id))})},0)}},"undefined"!=typeof module&&module.exports?module.exports=n:"function"==typeof define&&define.amd?define(function(){return n}):e.Micro=n}(window,document),function(){function e(e){this.id=e;var t={},n=t.hasOwnProperty;return{on:function(e,i){n.call(t,e)||(t[e]=[]);var o=t[e].push(i)-1;return{remove:function(){delete t[e][o]}}},fire:function(e,i){n.call(t,e)&&t[e].forEach(function(e){e(void 0!=i?i:{})})}}}"function"==typeof Micro&&Micro.prototype.isMicro?Micro.Pubsub=e:"undefined"!=typeof module&&module.exports?module.exports=e:"function"==typeof define&&define.amd?define(function(){return e}):window.Pubsub=e}(),function(e,t){function n(e,t){this.pages=e,this.events=t}n.prototype={invoke:function(){var e=this;return this.pages&&this.pages.forEach(function(t){e.doesMatch(t)&&e.events.fire("routeMatch",t)}),e},doesMatch:function(t){var n=e.location.pathname,i=!1;if(!t.match)return this.log(t.route+" rule has no callback"),i;var o=t.match.split("/");o.shift();var r=n.split("/");if(r.shift(),n==t.match&&(i=!0),o.length==r.length)for(var a=0;a<o.length;a++)0==o[a].search(":")&&(i=!0);return i},path:function(t){e.location.pathname!=t&&history.pushState({page:(new Date).getTime()},"",t),this.invoke()},log:function(e){console.log(e)}},"function"==typeof Micro&&Micro.prototype.isMicro?Micro.Router=n:"undefined"!=typeof module&&module.exports?module.exports=n:"function"==typeof define&&define.amd?define(function(){return n}):e.Router=n}(window,document),function(e,t){function n(e,t){this.props=e,this.events=t,this.props.enterAnimation,this.props.enterAnimation&&""!=this.props.enterAnimation&&this.embedAnimations()}n.prototype={tplCache:{},loadTpl:function(e){var t=this;if(this.activePage=e,t.events.fire("beforerender",{page:this.activePage}),this.isRouteCached(e))return void this.render(this.tplCache[e.tpl]);tplFile=this.props.tplDir+"/"+e.tpl;var n=new XMLHttpRequest;n.addEventListener("load",function(){(t.props.cache||e.cache)&&t.cacheRoute(e,n.responseText),t.render(n.responseText)}),n.open("GET",tplFile,!0),n.send()},isRouteCached:function(e){return this.tplCache&&this.tplCache.hasOwnProperty(e.tpl)},cacheRoute:function(e,t){this.tplCache[e.tpl]=t},render:function(e){var t=this,n=this.activePage.data||this.props.data||{},i=this.parseTpl(e,n);this.replaceHtml(i),setTimeout(function(){t.events.fire("render",{page:t.activePage})},0),this.animate()},replaceHtml:function(e){return void(t.getElementById(this.props.container).innerHTML=e)},parseTpl:function(e,t){return e.replace(RegExp("{{\\s*([a-z0-9_][.a-z0-9_]*)\\s*}}","gi"),function(e,n){for(var i=n.split("."),o=i.length,r=t,a=0;a<o;a++)r=r[i[a]]||"";return r})},animate:function(){var e=this;setTimeout(function(){var n=e.activePage.enterAnimation||e.props.enterAnimation;n&&(t.getElementById(e.props.container).className="animated "+n)},0)},log:function(e){console.log(e)},embedAnimations:function(){var e="microAnimationLibrary";if(!t.getElementById("microAnimationLibrary")){var n=t.createElement("link");n.href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css",n.rel="stylesheet",n.id=e,t.head.appendChild(n)}}},"function"==typeof Micro&&Micro.prototype.isMicro?Micro.Tpl=n:"undefined"!=typeof module&&module.exports?module.exports=n:"function"==typeof define&&define.amd?define(function(){return n}):e.Tpl=n}(window,document);