!function(e,t){function o(t){n=this,n.props=t,n.events=o.Pubsub,n.router=new o.Router(n.props.routes),n.tpl=new o.Tpl(n.props.options),n.urlPath=e.location.pathname,n.BreakException={},n.setListeners(),n.events.subscribe("routechange",function(e){n.tpl.loadTpl(e),n.tpl.props.listeners={rendered:function(){setTimeout(function(){n.setListeners()},0)}}}),e.onpopstate=n.router.invoke,n.router.invoke(),n.setListeners()}var n;o.prototype={isMicro:!0,aClick:function(t){var t=e.e||t,o=t.target;if("A"==o.tagName)return t.preventDefault(),void(o.hasAttribute("href")&&n.router.path(o.getAttribute("href")))},setListeners:function(){Array.prototype.slice.call(t.querySelectorAll("[hub-link]")).forEach(function(e){e.addEventListener?e.addEventListener("click",n.aClick,!1):e.attachEvent("onclick",n.aClick)})}},"undefined"!=typeof module&&module.exports?module.exports=o:"function"==typeof define&&define.amd?define(function(){return o}):e.Micro=o}(window,document),function(){var e={},t=e.hasOwnProperty,o={subscribe:function(o,n){t.call(e,o)||(e[o]=[]);var r=e[o].push(n)-1;return{remove:function(){delete e[o][r]}}},publish:function(o,n){t.call(e,o)&&e[o].forEach(function(e){e(void 0!=n?n:{})})}};"function"==typeof Micro&&Micro.prototype.isMicro?Micro.Pubsub=o:"undefined"!=typeof module&&module.exports?module.exports=o:"function"==typeof define&&define.amd?define(function(){return o}):window.Pubsub=o}(),function(e,t){function o(e){n=this,n.props=e,events=!(!Micro||!Micro.Pubsub)&&Micro.Pubsub,n.BreakException={}}var n=this;o.prototype={invoke:function(e){return n.props&&n.props.forEach(function(e){n.doesMatch(e)&&(e.afterrender&&"function"==typeof e.afterrender&&e.afterrender(),events&&events.publish("routechange",e))}),n},doesMatch:function(t){var o=e.location.pathname,r=!1;if(!t.rule)return n.log(t.route+" rule has no callback"),r;var i=t.rule.split("/");i.shift();var u=o.split("/");if(u.shift(),o==t.rule&&(r=!0),i.length==u.length)for(var c=0;c<i.length;c++)0==i[c].search(":")&&(r=!0);return r},path:function(t){e.location.pathname!=t&&(history.pushState({},"",t),this.invoke())},log:function(e){console.log(e)}},"function"==typeof Micro&&Micro.prototype.isMicro?Micro.Router=o:"undefined"!=typeof module&&module.exports?module.exports=o:"function"==typeof define&&define.amd?define(function(){return o}):e.Router=o}(window,document),function(e,t){function o(e){n=this,n.props=e}var n=this;o.prototype={tplCache:{},replaceHtml:function(e,o){var n="string"==typeof e?t.getElementById(e):e,r=n.cloneNode(!1);return r.innerHTML=o,n.parentNode.replaceChild(r,n),r},loadTpl:function(e){var t=this;return t.activePage=e,t.isRouteCached(e)?void t.render(this.tplCache[e.tpl]):(tplFile=this.props.tplDir+"/"+e.tpl,oReq=new XMLHttpRequest,oReq.addEventListener("load",function(){(t.props.cache||e.cache)&&t.cacheRoute(e,oReq.responseText),t.render(oReq.responseText)}),oReq.open("GET",tplFile),void oReq.send())},isRouteCached:function(e){return this.tplCache&&this.tplCache.hasOwnProperty(e.tpl)},cacheRoute:function(e,t){this.tplCache[e.tpl]=t},parseTpl:function(e,t){return e.replace(RegExp("{{\\s*([a-z0-9_][.a-z0-9_]*)\\s*}}","gi"),function(e,o){for(var n=o.split("."),r=n.length,i=t,u=0;u<r;u++)i=i[n[u]]||"";return i})},render:function(e){var o=n.activePage.data||n.props.data||{},r=this.parseTpl(e,o),i=t.getElementById(this.props.container);this.replaceHtml(i,r),n.props.listeners&&n.props.listeners.rendered()},log:function(e){console.log(e)}},"function"==typeof Micro&&Micro.prototype.isMicro?Micro.Tpl=o:"undefined"!=typeof module&&module.exports?module.exports=o:"function"==typeof define&&define.amd?define(function(){return o}):e.Tpl=o}(window,document);